<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sasani Music Library</title>
<style>
  body { background:#0b0b0b; color:#e0e0e0; font-family:Segoe UI, sans-serif; padding:1em; }
  a { color:#66ccff; text-decoration:none; }
  a:hover { text-decoration:underline; }
  ul { list-style-type:none; padding-left:1em; }
  li.folder > span { cursor:pointer; font-weight:bold; color:#99e0ff; }
  li.folder > ul { display:none; margin-left:1em; }
</style>
</head>
<body>
<h1>ðŸŽµ Sasani Music Library</h1>
<p>Click folders to expand. PDFs and MP3s open in new tabs.</p>

<div id="file-tree"></div>

<script>
async function fetchRepoTree() {
  const user = "Sasani-Likes-Penguins";
  const repo = "Sasani-Music";
  const apiUrl = `https://api.github.com/repos/${user}/${repo}/git/trees/main?recursive=1`;
  const res = await fetch(apiUrl);
  const data = await res.json();
  return data.tree.filter(item => item.type === "blob" || item.type === "tree");
}

function buildTree(data) {
  const tree = {};
  data.forEach(item => {
    const parts = item.path.split("/");
    let current = tree;
    parts.forEach((part, i) => {
      if (!current[part]) current[part] = (i === parts.length - 1 ? null : {});
      current = current[part];
    });
  });
  return tree;
}

function createList(tree, basePath = "") {
  const ul = document.createElement("ul");
  for (const name in tree) {
    const li = document.createElement("li");
    if (tree[name] === null) {
      const a = document.createElement("a");
      a.href = `${basePath}${name}`;
      a.textContent = name;
      a.target = "_blank";
      li.appendChild(a);
    } else {
      li.classList.add("folder");
      const span = document.createElement("span");
      span.textContent = name + "/";
      span.onclick = () => {
        const sub = li.querySelector("ul");
        sub.style.display = sub.style.display === "none" ? "block" : "none";
      };
      li.appendChild(span);
      li.appendChild(createList(tree[name], basePath + name + "/"));
    }
    ul.appendChild(li);
  }
  return ul;
}

fetchRepoTree().then(data => {
  const tree = buildTree(data);
  const root = document.getElementById("file-tree");
  root.appendChild(createList(tree));
});
</script>
</body>
</html>